<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShortLink & Image Page</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f7fa; margin:0; padding:20px; }
    .container { max-width:700px; margin:auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    h1 { text-align:center; }
    input[type=text] { width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:8px; }
    button { padding:10px 16px; margin:4px; border:none; border-radius:8px; cursor:pointer; }
    button.primary { background:#0b76ef; color:#fff; }
    button.secondary { background:#eaeef3; }
    img { max-width:100%; height:auto; margin-top:10px; border-radius:8px; border:1px solid #ddd; }
    .short { margin-top:10px; padding:10px; background:#f0f7ff; border:1px dashed #ccc; border-radius:8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="pageTitle">ShortLink & Image Page</h1>

    <label>Page Title:</label>
    <input type="text" id="titleInput" value="My Example Title">
    <button class="secondary" onclick="setTitle()">Apply Title</button>

    <label>Image URL:</label>
    <input type="text" id="imageUrl" value="https://upload.wikimedia.org/wikipedia/commons/3/3f/JPEG_example_flower.jpg" oninput="liveImageChange()">
    <img id="previewImage" src="https://upload.wikimedia.org/wikipedia/commons/3/3f/JPEG_example_flower.jpg" alt="Preview">

    <hr>

    <label>Enter URL to shorten:</label>
    <input type="text" id="originalUrl" placeholder="https://example.com">
    <button class="primary" onclick="shorten()">Shorten</button>
    <button class="secondary" onclick="copyShort()">Copy</button>
    <div id="shortOutput" class="short" style="display:none"></div>
  </div>

  <script>
    // --- Title Function ---
    function setTitle(){
      const t = document.getElementById("titleInput").value;
      document.getElementById("pageTitle").textContent = t || "ShortLink & Image Page";
      document.title = t;
    }

    // --- Live Image Preview ---
    function liveImageChange(){
      const url = document.getElementById("imageUrl").value.trim();
      const img = document.getElementById("previewImage");
      img.src = url;
      img.onerror = ()=>{ 
        img.src = "https://upload.wikimedia.org/wikipedia/commons/3/3f/JPEG_example_flower.jpg";
      };
    }

    // --- Short Link Functions ---
    const key = "short_links_db";
    function loadLinks(){ return JSON.parse(localStorage.getItem(key) || "{}"); }
    function saveLinks(data){ localStorage.setItem(key, JSON.stringify(data)); }
    function genId(){ return Math.floor(100000 + Math.random() * 900000); } // always 6-digit unique number

    function shorten(){
      const url = document.getElementById("originalUrl").value.trim();
      if(!url){ alert("Enter a URL first."); return; }
      let links = loadLinks();
      let id = genId();
      while(links[id]){ id = genId(); } // ensure unique
      links[id] = url;
      saveLinks(links);
      const short = location.origin + location.pathname + "#s/" + id;
      document.getElementById("shortOutput").style.display="block";
      document.getElementById("shortOutput").textContent = short;
    }

    function copyShort(){
      const txt = document.getElementById("shortOutput").textContent;
      if(!txt){ alert("No short link yet."); return; }
      navigator.clipboard.writeText(txt).then(()=>alert("Copied!"));
    }

    // --- Redirect if visiting #s/xxx ---
    (function(){
      if(location.hash.startsWith("#s/")){
        const id = location.hash.replace("#s/","");
        const links = loadLinks();
        if(links[id]) location.href = links[id];
        else alert("Short link not found in this browser.");
      }
    })();
  </script>
</body>
</html>
    const toggleLang = document.getElementById('toggleLang');

    const texts = {
      saraiki: {
        titlePlaceholder: 'Apna title ethe pao',
        desc: 'Image, title te short link asaani nal banaao. Language toggle naal English v dekho.' ,
        shorten: 'Shorten',
        copy: 'Short URL copy karo',
        apply: 'Apply',
        resetImage: 'Reset Image'
      },
      english: {
        titlePlaceholder: 'Enter title here',
        desc: 'Add an image, give a title and create a short link easily. Use the language toggle to switch to Saraiki.',
        shorten: 'Shorten',
        copy: 'Copy Short URL',
        apply: 'Apply',
        resetImage: 'Reset Image'
      }
    };

    let currentLang = 'english';
    function updateLangUI(){
      const t = texts[currentLang];
      titleInput.placeholder = t.titlePlaceholder;
      desc.textContent = t.desc;
      shortenBtn.textContent = t.shorten;
      copyBtn.textContent = t.copy;
      applyTitle.textContent = t.apply;
      resetImage.textContent = t.resetImage;
      toggleLang.textContent = currentLang === 'english' ? 'Saraiki' : 'English';
    }

    toggleLang.addEventListener('click', ()=>{
      currentLang = currentLang === 'english' ? 'saraiki' : 'english';
      updateLangUI();
    });

    applyTitle.addEventListener('click', ()=>{
      pageTitle.textContent = titleInput.value || 'ShortLink & Image Page';
      document.title = pageTitle.textContent;
    });

    applyImage.addEventListener('click', ()=>{
      const url = imageUrl.value.trim();
      if(url){
        previewImage.src = url;
        previewImage.onerror = ()=>{
          alert('Image could not be loaded. Please use a direct image link (.jpg, .png).');
          previewImage.src = 'https://upload.wikimedia.org/wikipedia/commons/9/99/Sample_User_Icon.png';
        };
      }
    });

    resetImage.addEventListener('click', ()=>{
      const def = 'https://upload.wikimedia.org/wikipedia/commons/9/99/Sample_User_Icon.png';
      previewImage.src = def;
      imageUrl.value = def;
    });

    shortenBtn.addEventListener('click', ()=>{
      const url = (originalUrl.value||'').trim();
      if(!url){ alert('Please enter a URL to shorten.'); return; }
      const links = loadLinks();
      for(const k in links){ if(links[k] === url){ showShort(k); return; } }
      let id = genId(6);
      while(links[id]) id = genId(6);
      links[id] = url;
      saveLinks(links);
      showShort(id);
    });

    function showShort(id){
      const short = location.origin + location.pathname + '#s/' + id;
      shortLabel.textContent = short;
      shortOutput.style.display = 'block';
    }

    copyBtn.addEventListener('click', ()=>{
      const txt = shortLabel.textContent || '';
      if(!txt){ alert('No short link to copy'); return; }
      navigator.clipboard.writeText(txt).then(()=>{
        alert('Short link copied to clipboard');
      }).catch(()=>alert('Copy failed â€” you can select and copy manually.'));
    });

    updateLangUI();
    titleInput.value = pageTitle.textContent;
  </script>
</body>
</html>
